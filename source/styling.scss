 /*
 ~  Copyright (c) 2017 Nicola Fiori (JD342)
 ~
 ~  This file is part of the Arc Integration for Thunderbird, licensed under
 ~  the terms of the GNU General Public License 3.0.
 ~
 */

/* -- general --------------------------------------------------------------- */

:root {

    /* color palette */

    --ait-blue: #5294e2;
    --ait-red: #f37076;

    --ait-button-active-text-color: #ffffff;

    --ait-light-window-frame-background-color: #e7e8eb;
    --ait-light-pane-background-color: #f5f6f7;
    --ait-light-pane-border-color: #d2d3d8;
    --ait-light-side-pane-background-color: #fbfbfc;
    --ait-light-content-background-color: #ffffff;
    --ait-light-content-border-color: #dcdfe3;
    --ait-light-input-border-color: #cfd6e6;
    --ait-light-input-placeholder-color: #a7aab0;
    --ait-light-button-active-border-color: #5294e2;
    --ait-light-text-input-icon-color: #7d8189;
    --ait-light-button-background-color: #fbfbfc;
    --ait-light-button-hover-background-color: #ffffff;
    --ait-light-text-color: #5c616c;
    --ait-light-actions-box-background-color: #edeef0;

    --ait-dark-window-frame-background-color: #2f343f;
    --ait-dark-pane-background-color: #383c4a;
    --ait-dark-pane-border-color: #252a33;
    --ait-dark-side-pane-background-color: #3c4150;
    --ait-dark-content-background-color: #404552;
    --ait-dark-content-border-color: #2b2e39;
    --ait-dark-button-active-border-color: #2b2e39;
    --ait-dark-input-border-color: #2b2e39;
    --ait-dark-input-placeholder-color: #8e95a0;
    --ait-dark-text-input-icon-color: #b6bcc6;
    --ait-dark-button-background-color: #444a58;
    --ait-dark-button-hover-background-color: #505666;
    --ait-dark-text-color: #d3dae3;
    --ait-dark-actions-box-background-color: #313541;

    /* dimensions */

    --ait-actions-box-height: 34px;
    --ait-input-border-radius: 3px;
    --ait-input-height: 28px;
    --ait-input-font-size: 14.37px;
    --ait-input-horizontal-padding: 6px;

    --ait-pixel-ratio: 1;

    @media (min-resolution: 2dppx) { --ait-pixel-ratio: 2; }
    @media (min-resolution: 3dppx) { --ait-pixel-ratio: 3; }
    @media (min-resolution: 4dppx) { --ait-pixel-ratio: 4; }

    /* computed values */

    --ait-actions-box-input-margin: calc((var(--ait-actions-box-height) -
                                          var(--ait-input-height)) / 2);
    --ait-input-text-vertical-spacing: calc((var(--ait-input-height) -
                                             var(--ait-input-font-size)) / 2);

}

@function pref($name, $values...) {

    // pref(foo, light)
    //  -> [ait-foo-preference="light"]
    //
    // pref(foo, dark, light)
    //  -> :-moz-any([ait-foo-preference="dark"], [ait-foo-preference="light"])

    $list: ();

    @each $value in $values {

        $list: append($list, '[ait-#{ $name }-preference="#{ $value }"]');

    }

    @if length($list) == 1 {

        @return nth($list, 1);

    }

    @return ':-moz-any(#{ zip($list) })';

}

@function pref-not-none($name) {

    // pref-not-none(foo)
    //  -> :not([ait-foo-preference="none"])

    @return ':not([ait-#{ $name }-preference="none"])';

}

/* -- icons ----------------------------------------------------------------- */

:root {

    @each $variant in light, dark {

        &:-moz-any(#calendar-event-dialog,
                   #calendar-task-dialog,
                   #addressbookWindow)#{ pref(frame-contents, $variant) }
            svg[id|="ait-toolset-button"],

        &#messengerWindow[ait-lightning-side-pane-preference="light"]
            svg[id|="ait-lightning-side-pane"],

        &#messengerWindow#{ pref(lightning-side-pane, $variant) }
            svg[id|="ait-lightning-side-pane"],

        &#messengerWindow#{ if($variant == light,
                               pref(main-toolbox, light, darker),
                               pref(main-toolbox, dark)) }
            svg:-moz-any([id|="ait-pane-toolset-button"],
                         [id|="ait-selected-tab-close"]),

        &#messengerWindow#{ pref(lightning-panel, $variant) }
            svg[id|="ait-lightning-panel"],

        &#messengerWindow#{ pref(frame-contents, $variant) }
            svg:-moz-any([id|="ait-frame-toolset-button"],
                         [id|="ait-tab-close"])

        {

            --ait-icon-color: var(--ait-#{ $variant }-text-color);

        }

        &#messengerWindow#{ if($variant == light,
                               pref(main-toolbox, light, darker),
                               pref(main-toolbox, dark)) }
            svg[id|="ait-pane-toolset-searchbox"],

        &#addressbookWindow#{ pref(frame-contents, $variant) }
            svg[id|="ait-toolset-searchbox"],

        &#messengerWindow#{ pref(lightning-panel, $variant) }
            svg[id|="ait-lightning-panel-searchbox"],

        &#messengerWindow#{ pref(frame-contents, $variant) }
            svg[id|="ait-frame-toolset-searchbox"],

        &#messengerWindow#{ pref(mails-panel, $variant) }
            svg[id|="ait-mails-view-searchbox"]

        {

            --ait-icon-color: var(--ait-#{ $variant }-text-input-icon-color);

        }

    }

    &#messengerWindow svg {

        &[id|="ait-tab-hover-button-close"] {

            --ait-icon-color: var(--ait-red);

        }

        &[id|="ait-tab-active-button-close"] {

            --ait-icon-color: var(--ait-blue);

        }

        &:-moz-any([id|="ait-toolset-active-button"],
                   [id|="ait-frame-toolset-button"],
                   [id|="ait-pane-toolset-button"]) {

            &[id$="schedule-icon"] {

                transform: translateY(-1px);

            }

            &[id$="filter-icon"] {

                transform: scale(1.25, 1.25);

            }

        }

    }

    &:-moz-any(#calendar-event-dialog,
               #calendar-task-dialog,
               #addressbookWindow,
               #messengerWindow) svg[id|="ait-toolset-active-button"] {

        --ait-icon-color: var(--ait-button-active-text-color) !important;

    }

    &#addressbookWindow
        svg:-moz-any([id|="ait-toolset-active-button"],
                     [id|="ait-toolset-button"])[id$="write-icon"],

    &#messengerWindow svg:-moz-any(
        [id|="ait-toolset-active-button"],
        [id|="ait-frame-toolset-button"],
        [id|="ait-pane-toolset-button"]
    ):-moz-any([id$="filter-icon"], [id$="write-icon"])

    {

        & path {

            stroke: var(--ait-icon-color);
            stroke-width: 0.8px;

        }

    }

}

svg[id|="ait"] {

    width: 16px;
    height: 16px;

    & :-moz-any(path, rect) {

        fill: var(--ait-icon-color);

    }

}

/* -- generic tweaks -------------------------------------------------------- */

:root#messengerWindow {

    &:not([ait-main-toolbox-preference="none"]) #contentTabBrowser0 {

        /* puts content windows (for ex. Add-ons Manager) on top to hide
           artifacts from the tab browser  */

        z-index: 2;
        position: relative;

    }

}

/* -- borders, separators & splitters --------------------------------------- */

:root {

    @each $variant in light, dark {

        &#addressbookWindow#{ pref(dialogs-content, $variant) } #abContent,
        &#messengerWindow#{ pref(mails-panel, $variant) } #messengerBox {

            --ait-border-color: var(--ait-#{ $variant }-content-border-color);

        }

        &#messengerWindow#{ pref(lightning-panel, $variant) } #calendarContent,

        &#messengerWindow#{ pref(lightning-side-pane, $variant) }
            :-moz-any(#today-splitter, #today-pane-panel)

        {

            --ait-border-color: var(--ait-#{ $variant }-pane-border-color);

        }

    }

    &#addressbookWindow#{ pref-not-none(dialogs-content) } #abContent splitter,
    &#messengerWindow#{ pref-not-none(mails-panel) } #messengerBox splitter,

    &#messengerWindow#{ pref-not-none(lightning-side-pane) }
        #today-splitter,

    &#messengerWindow#{ pref-not-none(lightning-panel) }
        #calendarContent splitter

    {

        transition: border-color 300ms ease !important;
        border-color: var(--ait-border-color) !important;
        border-inline-end-color: var(--ait-border-color);
        border-inline-start-color: var(--ait-border-color);

        &:hover {

            border-color: var(--ait-blue) !important;

        }

    }

    &#messengerWindow#{ pref-not-none(lightning-side-pane) } #today-pane-panel,
    &#messengerWindow#{ pref-not-none(lightning-panel) } #ltnSidebar,

    &#messengerWindow#{ pref-not-none(mails-panel) }
        :-moz-any(#quick-filter-bar, #messagepanebox, #folderTree, #threadTree),

    &#addressbookWindow#{ pref-not-none(dialogs-content) }
        :-moz-any(#CardViewOuterBox, #dirTree)

    {

        border-bottom-color: var(--ait-border-color);

    }

}

/* -- frame styling --------------------------------------------------------- */

:root {

    @each $variant in light, dark {

        &#{ pref(frame-background, $variant) } {

            --ait-frame-background-color:
                var(--ait-#{ $variant }-window-frame-background-color);

        }

    }

    &#{ pref-not-none(frame-background) } {

        &:-moz-any(#calendar-event-dialog,
                   #calendar-task-dialog,
                   #addressbookWindow,
                   #messengerWindow) .toolbox-top > * {

            -moz-appearance: none;
            background: var(--ait-frame-background-color) !important;

        }

    }

    &:-moz-any(#calendar-event-dialog,
               #calendar-task-dialog,
               #addressbookWindow) {

        @each $variant in light, dark {

            &#{ pref(frame-background, $variant) } {

                --ait-frame-lower-border-color:
                    var(--ait-#{ $variant }-pane-border-color);

            }

        }

        &#{ pref-not-none(frame-background) } .toolbox-top::after {

            content: "";
            height: 1px;
            width: 100%;
            display: block;
            background: var(--ait-frame-lower-border-color);

        }

    }

}

/* -- toolbox content styling ----------------------------------------------- */

:root {

    --ait-toolbox-items-margin: 5px;

    &:-moz-any(#calendar-event-dialog, #calendar-task-dialog) {

        --ait-toolset-button-down-arrow-icon:
            -moz-element(#ait-toolset-button-down-arrow-icon);

    }

    &#messengerWindow {

        &.toolbox-top {

            --ait-toolset-button-down-arrow-icon:
                -moz-element(#ait-frame-toolset-button-down-arrow-icon);

        }

        & .mail-toolbox {

            --ait-toolset-button-down-arrow-icon:
                -moz-element(#ait-pane-toolset-button-down-arrow-icon);

        }

    }

    &:-moz-any(#calendar-event-dialog,
               #calendar-task-dialog,
               #messengerWindow) {

        --ait-toolset-active-button-down-arrow-icon:
            -moz-element(#ait-toolset-active-button-down-arrow-icon);

    }

    @each $variant in light, dark {

        &:-moz-any(#calendar-event-dialog,
                   #calendar-task-dialog,
                   #addressbookWindow)#{ pref(frame-contents, $variant) },

        &#messengerWindow#{ if($variant == light,
                               pref(main-toolbox, light, darker),
                               pref(main-toolbox, dark)) } .mail-toolbox,

        &#messengerWindow#{ pref(frame-contents, $variant) } .toolbox-top
            .chromeclass-menubar

        {

            --ait-toolbox-text-color: var(--ait-#{ $variant }-text-color);

            --ait-toolbox-border-color:
                var(--ait-#{ $variant }-pane-border-color);

            --ait-toolbox-button-border-color:
                var(--ait-#{ $variant }-input-border-color);

            --ait-toolbox-button-background-color:
                var(--ait-#{ $variant }-button-background-color);

            --ait-toolbox-button-active-border-color:
                var(--ait-#{ $variant }-button-active-border-color);

            --ait-toolbox-button-hover-background-color:
                var(--ait-#{ $variant }-button-hover-background-color);

        }

    }

    &#messengerWindow#{ pref-not-none(main-toolbox) } .mail-toolbox,

    &#messengerWindow#{ pref-not-none(frame-contents) } .toolbox-top
        .chromeclass-menubar,

    &:-moz-any(#calendar-event-dialog,
               #calendar-task-dialog,
               #addressbookWindow)#{ pref-not-none(frame-contents) }
        .toolbox-top

    {

        & toolbarseparator {

            min-width: 1px;
            min-height: 100%;
            -moz-appearance: none !important;
            background: var(--ait-toolbox-border-color);
            margin: 0 calc(var(--ait-toolbox-items-margin) / 2);

        }

        & dropmarker {

            -moz-appearance: none;

        }

        & .toolbarbutton-text {

            font-size: 0.96em;
            margin: 0 2px !important;
            transition: color 200ms ease-out;
            color: var(--ait-toolbox-text-color);

        }

        & .toolbarbutton-icon {

            margin: 2px;
            width: 16px;
            height: 16px;
            background-size: contain;
            background-repeat: no-repeat;

        }

        & .dropmarker-icon {

            margin: 0 4px;
            background-size: 16px 16px;
            background-image: var(--ait-toolset-button-down-arrow-icon);


        }

        & .toolbarbutton-1 {

            background: none;
            box-shadow: none;
            min-height: var(--ait-input-height);
            border-radius: var(--ait-input-border-radius);
            margin: 0 calc(var(--ait-toolbox-items-margin) / 2);
            transition: background 200ms ease-out, border-color 200ms ease-out;

            &[type="menu-button"],
            &:not([disabled="true"]):hover {

                background: var(--ait-toolbox-button-background-color);

            }

            &[type="menu-button"] dropmarker,
            &[type="menu"] {

                &[open="true"] .dropmarker-icon {

                    background-image:
                        var(--ait-toolset-active-button-down-arrow-icon);

                }

            }

            &:not([type="menu-button"]):not(.toolbarbutton-menubutton-button) {

                &:not([disabled="true"]) {

                    &:hover {

                        border-color: var(--ait-toolbox-button-border-color);
                        background: var(--ait-toolbox-button-background-color);

                    }

                    &:-moz-any(:active, [open="true"], [checked="true"]) {

                        transition: none;
                        background: var(--ait-blue);

                        border-color:
                            var(--ait-toolbox-button-active-border-color);

                        & .toolbarbutton-text {

                            transition: none;
                            color: var(--ait-button-active-text-color);

                        }

                    }

                }

            }

            &[type="menu-button"] {

                border: none;

                & dropmarker::before {

                    display: none;

                }

                & .toolbarbutton-menubutton-button:active .toolbarbutton-text {

                    color: var(--ait-button-active-text-color);

                }

                & :-moz-any(.toolbarbutton-menubutton-button,
                            .toolbarbutton-menubutton-dropmarker) {

                    border: none;
                    background: rgba(0,0,0,0);
                    box-shadow: none;
                    border-top: 1px solid
                                var(--ait-toolbox-button-border-color);
                    border-bottom: 1px solid
                                   var(--ait-toolbox-button-border-color);

                }

                & .toolbarbutton-menubutton-button {

                    transition: background 300ms ease;
                    border-top-left-radius: var(--ait-input-border-radius);
                    border-bottom-left-radius: var(--ait-input-border-radius);
                    border-left: 1px solid
                                 var(--ait-toolbox-button-border-color);
                    padding-right: calc(var(--ait-input-horizontal-padding) +
                                        1px);

                }

                & .toolbarbutton-menubutton-dropmarker {

                    z-index: 2;
                    padding: 0 2px;
                    position: relative;
                    background: none;
                    box-shadow: -1px 0 rgba(0,0,0,0);
                    border-top-right-radius: var(--ait-input-border-radius);
                    border-bottom-right-radius: var(--ait-input-border-radius);
                    transition: background 300ms ease,
                                box-shadow 300ms ease;
                    border-right: 1px solid
                                  var(--ait-toolbox-button-border-color);

                }

                &:hover .toolbarbutton-menubutton-dropmarker {

                    box-shadow: -1px 0 var(--ait-toolbox-button-border-color);

                }

                &:not(:active) .toolbarbutton-menubutton-button:hover,

                &:not([open="true"]):hover
                    .toolbarbutton-menubutton-button:not(:hover) +
                        .toolbarbutton-menubutton-dropmarker

                {

                    background:
                        var(--ait-toolbox-button-hover-background-color);

                }

                & :-moz-any(.toolbarbutton-menubutton-button:active,
                            .toolbarbutton-menubutton-dropmarker[open="true"]) {

                    transition: none !important;
                    background: var(--ait-blue) !important;
                    border-color: var(--ait-toolbox-button-active-border-color)
                                  !important;

                }

            }

        }

    }

}

/* -- tabs and toolbox common ----------------------------------------------- */

:root#messengerWindow {

    &#{ pref(main-toolbox, light, darker) } {

        --ait-tab-and-toolbox-border-color:
            var(--ait-light-pane-border-color);

        --ait-tab-and-toolbox-background-color:
            var(--ait-light-pane-background-color);

    }

    &#{ pref(main-toolbox, light) } {

        --ait-tab-hover-background-opacity: 0.6;

        --ait-tab-and-toolbox-upper-border-color:
            var(--ait-light-pane-border-color);

    }

    &#{ pref(main-toolbox, darker) } {

        --ait-tab-hover-background-opacity: 0.25;

        --ait-tab-and-toolbox-upper-border-color:
            var(--ait-dark-pane-border-color);

    }

    &#{ pref(main-toolbox, dark) } {

        --ait-tab-hover-background-opacity: 0.6;

        --ait-tab-and-toolbox-border-color:
            var(--ait-dark-pane-border-color);

        --ait-tab-and-toolbox-upper-border-color:
            var(--ait-dark-pane-border-color);

        --ait-tab-and-toolbox-background-color:
            var(--ait-dark-pane-background-color);

        --ait-toolbox-button-background-hover-color:
            var(--ait-dark-button-hover-background-color);

    }

}

/* -- tabs styling & side icons --------------------------------------------- */

:root#messengerWindow {

    &#{ pref-not-none(frame-contents) } {

        & :-moz-any(#calendar-tab-button,
                    #task-tab-button) .toolbarbutton-icon {

            width: 16px !important;
            height: 16px !important;
            list-style-image: none !important;

        }

        & #calendar-tab-button .toolbarbutton-icon {

            background-image:
                -moz-element(#ait-frame-toolset-button-calendar-icon);

        }

        & #task-tab-button .toolbarbutton-icon {

            background-image:
                -moz-element(#ait-frame-toolset-button-task-icon);

        }

    }

    &#{ pref-not-none(main-toolbox) } {

        --ait-tab-border-radius: 1.1px;

        & #appmenuSecondaryPane {

            border-color: var(--ait-border-color);
            background: var(--ait-side-pane-background-color);

        }

        & #tabs-toolbar {

            padding-top: 1px;
            margin-left: -10px;
            position: relative;
            box-shadow: inset 0 -1px
                        var(--ait-tab-and-toolbox-upper-border-color);

            & .tab-background {

                background: none !important;

                &::after {

                    left: 0;
                    bottom: 0;
                    content: "";
                    width: 100%;
                    height: 1px;
                    display: block;
                    position: absolute;

                    box-shadow:
                        2px 0 var(--ait-tab-and-toolbox-background-color),
                        -2px 0 var(--ait-tab-and-toolbox-background-color);

                }

            }

            & :-moz-any(.tab-background-start,
                        .tab-background-middle,
                        .tab-background-end) {

                overflow: hidden;
                margin-bottom: -1px;
                opacity: 0 !important;
                height: 10px !important;

            }

            & .tab-background-middle {

                border: none;
                margin-top: 1px;
                border-top-left-radius: var(--ait-tab-border-radius);
                border-top-right-radius: var(--ait-tab-border-radius);
                background: var(--ait-tab-and-toolbox-background-color)
                            !important;
                box-shadow: 0 0 0 1px
                            var(--ait-tab-and-toolbox-upper-border-color);

                &[selected="true"] {

                    opacity: 1 !important;

                }

            }

            & .tabmail-tab {

                &::before {

                    display: none;

                }

                &[selected="true"] .tab-close-button {

                    background-image: -moz-element(#ait-selected-tab-close-icon)
                                      !important;

                }

                &:hover:not([selected="true"]) .tab-background-middle {

                    position: relative;
                    opacity: 1 !important;
                    padding: 0 !important;
                    background: none !important;

                    &::before {

                        top: 0;
                        left: 0;
                        content: "";
                        width: 100%;
                        display: block;
                        position: absolute;
                        height: calc(100% - 3px);
                        opacity: var(--ait-tab-hover-background-opacity);
                        background: var(--ait-tab-and-toolbox-background-color);

                    }

                }

            }

            & .tab-close-button {

                position: relative;
                background-image: -moz-element(#ait-tab-close-icon)
                                  !important;

                &::before {

                    opacity: 0;
                    content: "";
                    width: 16px;
                    height: 16px;
                    display: block;
                    pointer-events: none;
                    transition: opacity 300ms ease;

                    background-image:
                        -moz-element(#ait-tab-hover-button-close-icon);

                }

                & image {

                    display: none;

                }

                &:hover::before {

                    opacity: 1;

                }

                &:active::before {

                    background-image:
                        -moz-element(#ait-tab-active-button-close-icon);

                }

            }

        }

        &#{ pref-not-none(frame-contents) }
            :-moz-any(#calendar-tab-button, #task-tab-button) {

            width: 36px;
            height: 27px;
            margin-top: 0;
            border-radius: 0;
            transition: none;
            border-bottom: none;
            box-shadow: none !important;
            border: 1px solid rgba(0,0,0,0);
            border-top-left-radius: var(--ait-tab-border-radius);
            border-top-right-radius: var(--ait-tab-border-radius);

            &:hover {

                background: var(--ait-tab-and-toolbox-hover-color)
                            !important;
                border-color: var(--ait-tab-and-toolbox-upper-border-color)
                              !important;

                &::before {

                    content: "";
                    width: 34px;
                    height: 27px;
                    display: block;
                    position: absolute;
                    transform: translate(-6px, -50%);
                    opacity: var(--ait-tab-hover-background-opacity);
                    background: var(--ait-tab-and-toolbox-background-color);

                }

            }

            & .toolbarbutton-icon {

                position: relative;

            }


        }

    }

}

/* -- toolbox styling ------------------------------------------------------- */

:root#messengerWindow#{ pref-not-none(main-toolbox) } {

    --ait-toolbox-height: 36px;
    --ait-toolbox-items-margin: 5px;

    & .mail-toolbox {

        display: flex;
        flex-flow: column;
        box-shadow: none !important;
        background: var(--ait-tab-and-toolbox-background-color) !important;

        &::after {

            background-color: var(--ait-tab-and-toolbox-border-color)
                              !important;

        }

        & > toolbar {

            display: flex;
            flex-flow: row;
            position: relative;
            align-items: center;
            -moz-appearance: none;
            min-height: var(--ait-toolbox-height);
            margin: 0 calc(var(--ait-toolbox-items-margin) / 2) !important;

            & > * {

                flex-shrink: 0;

            }

        }

        & :-moz-any(toolbarspring, toolbarpaletteitem[type="spring"]) {

            flex: 1 1;
            height: 100%;

        }

    }

}

/* -- toolbox icons --------------------------------------------------------- */

:root {

    @mixin common-btn-styling($active-icon-prefix,
                              $icon-suffix,
                              $icon-prefix,
                              $btn-type,
                              $btn-id) {

        $btn-selector: map_get((
            btn:         '##{ $btn-id }',
            menubtn-btn: '##{ $btn-id } .toolbarbutton-menubutton-button',
            check-btn:   '##{ $btn-id }',
            toggle-btn:  '##{ $btn-id }',
            appmenu-btn: '##{ $btn-id }'
        ), $btn-type);

        $btn-icon-selector: map_get((
            btn:         '.toolbarbutton-icon',
            menubtn-btn: '.toolbarbutton-icon',
            check-btn:   '.toolbarbutton-icon',
            toggle-btn:  '.toolbarbutton-icon',
            appmenu-btn: '.toolbarbutton-icon[label="AppMenu"]'
        ), $btn-type);

        $active-selector: map_get((
            btn:         ':active',
            menubtn-btn: ':active',
            check-btn:   ':-moz-any(:active, [checked="true"])',
            toggle-btn:  ':-moz-any(:active, [open="true"])',
            appmenu-btn: ':-moz-any(:active, [open="true"])'
        ), $btn-type);

        & #{ $btn-selector } {

            --ait-toolset-button-icon:
                #{ '-moz-element(#ait-' +
                                 $icon-prefix +
                                 '-' +
                                 $icon-suffix +
                                 '-icon)' };

            &#{ $active-selector } {

                --ait-toolset-button-icon:
                    #{ '-moz-element(#ait-' +
                                     $active-icon-prefix +
                                     '-' +
                                     $icon-suffix +
                                     '-icon)' };

            }

            & .toolbarbutton-icon {

                list-style-image: none;
                background-image: var(--ait-toolset-button-icon);

            }

        }

    }

    @mixin btn-styling($btn-type, $btn-id, $icon-name) {

        &#{ pref-not-none(frame-contents) } {

            @include common-btn-styling(
                $active-icon-prefix: 'toolset-active-button',
                $icon-prefix: 'toolset-button',
                $icon-suffix: $icon-name,
                $btn-type: $btn-type,
                $btn-id: $btn-id
            );

        }

    }

    &:-moz-any(#calendar-event-dialog, #calendar-task-dialog) {

        @include btn-styling(btn, button-save,      save);
        @include btn-styling(btn, button-delete,    delete);
        @include btn-styling(btn, button-attendees, avatar);

        @include btn-styling(check-btn, button-timezones, globe);

        @include btn-styling(menubtn-btn, button-privacy,  lock);
        @include btn-styling(menubtn-btn, button-freebusy, time);
        @include btn-styling(menubtn-btn, button-status,   status);
        @include btn-styling(menubtn-btn, button-url,      attachment);
        @include btn-styling(menubtn-btn, button-priority, important);

    }

    &#addressbookWindow {

        @include btn-styling(btn, button-newlist,    book);
        @include btn-styling(btn, button-newmessage, write);
        @include btn-styling(btn, button-abdelete,   delete);
        @include btn-styling(btn, button-newim,      message);
        @include btn-styling(btn, button-newcard,    contact);
        @include btn-styling(btn, button-editcard,   properties);

    }

    @mixin btn-styling($btn-type, $btn-id, $icon-name) {

        &#{ pref-not-none(frame-contents) } .toolbox-top {

            @include common-btn-styling(
                $active-icon-prefix: 'toolset-active-button',
                $icon-prefix: 'frame-toolset-button',
                $icon-suffix: $icon-name,
                $btn-type: $btn-type,
                $btn-id: $btn-id
            );

        }

        &#{ pref-not-none(main-toolbox) } .mail-toolbox {

            @include common-btn-styling(
                $active-icon-prefix: 'toolset-active-button',
                $icon-prefix: 'pane-toolset-button',
                $icon-suffix: $icon-name,
                $btn-type: $btn-type,
                $btn-id: $btn-id
            );

        }

    }

    &#messengerWindow {

        @include btn-styling(toggle-btn, button-tag, tag);

        @include btn-styling(menubtn-btn, button-getmsg, inbox);
        @include btn-styling(menubtn-btn, button-newmsg, write);

        @include btn-styling(btn, task-delete-button,     delete);
        @include btn-styling(btn, calendar-delete-button, delete);

        @include btn-styling(btn, task-edit-button,     properties);
        @include btn-styling(btn, calendar-edit-button, properties);

        @include btn-styling(btn, task-synchronize-button,     sync);
        @include btn-styling(btn, calendar-synchronize-button, sync);

        @include btn-styling(btn, lightning-button-tasks, task);
        @include btn-styling(btn, button-chat,            message);
        @include btn-styling(btn, button-address,         address-book);

        @include btn-styling(btn, lightning-button-calendar,  calendar);
        @include btn-styling(btn, calendar-goto-today-button, calendar);

        @include btn-styling(menubtn-btn, extractTaskButton,       new);
        @include btn-styling(btn,         task-newtask-button,     new);
        @include btn-styling(btn,         calendar-newtask-button, new);

        @include btn-styling(menubtn-btn, button-print,          print);
        @include btn-styling(btn,         task-print-button,     print);
        @include btn-styling(btn,         calendar-print-button, print);

        @include btn-styling(appmenu-btn, button-appmenu,          menu);
        @include btn-styling(appmenu-btn, task-appmenu-button,     menu);
        @include btn-styling(appmenu-btn, calendar-appmenu-button, menu);

        @include btn-styling(check-btn, qfb-show-filter-bar,       filter);
        @include btn-styling(check-btn, calendar-unifinder-button, search);

        @include btn-styling(menubtn-btn, extractEventButton,       schedule);
        @include btn-styling(btn,         task-newevent-button,     schedule);
        @include btn-styling(btn,         calendar-newevent-button, schedule);

    }

}

/* -- text boxes ------------------------------------------------------------ */

:root {

    @each $variant in light, dark {

        &#messengerWindow#{ pref(lightning-panel, $variant) } #calendarContent,
        &#messengerWindow#{ pref(mails-panel, $variant) } #messengerBox,
        &#addressbookWindow#{ pref(frame-contents, $variant) },

        &#messengerWindow#{ if($variant == light,
                               pref(main-toolbox, light, darker),
                               pref(main-toolbox, dark)) } .mail-toolbox,

        &#messengerWindow#{ pref(lightning-side-pane, $variant) }
            #today-pane-panel

        {

            --ait-input-border-color:
                var(--ait-#{ $variant }-input-border-color);

            --ait-input-background-color:
                var(--ait-#{ $variant }-content-background-color);

            & textbox {

                @if $variant == light {

                    transition: border-color 100ms linear;

                    &[focused="true"] {

                        border-color: var(--ait-blue) !important;

                    }

                }

                @else {

                    transition: box-shadow 100ms linear;
                    box-shadow: inset 0 0 0 1px transparent;

                    &[focused="true"] {

                        box-shadow: inset 0 0 0 1px var(--ait-blue);

                    }

                }

            }

        }

    }

    &#messengerWindow {

        &#{ pref-not-none(main-toolbox) } {

            & .mail-toolbox {

                --ait-searchbox-search-icon:
                    -moz-element(#ait-pane-toolset-searchbox-search-icon);

                & .gloda-search-icon {

                    margin: 3px;
                    width: 16px;
                    height: 16px;
                    list-style-image: none;
                    background-size: contain;
                    background-repeat: no-repeat;
                    background-image: var(--ait-searchbox-search-icon);

                }

            }

            & #messengerBox {

                --ait-searchbox-search-icon:
                    -moz-element(#ait-mails-view-searchbox-search-icon);

            }

        }

        &#{ pref-not-none(lightning-panel) } #calendarContent {

            --ait-searchbox-search-icon:
                -moz-element(#ait-lightning-panel-searchbox-search-icon);

        }

    }

    &#addressbookWindow#{ pref-not-none(frame-contents) } {

        --ait-searchbox-search-icon:
            -moz-element(#ait-toolset-searchbox-search-icon);

    }

    &#messengerWindow#{ pref-not-none(lightning-side-pane) } #today-pane-panel,
    &#messengerWindow#{ pref-not-none(lightning-panel) } #calendarContent,
    &#addressbookWindow#{ pref-not-none(frame-contents) } .toolbox-top,
    &#messengerWindow#{ pref-not-none(main-toolbox) } .mail-toolbox,
    &#messengerWindow#{ pref-not-none(mails-panel) } #messengerBox {

        & textbox {

            -moz-appearance: none;
            height: var(--ait-input-height);
            background: var(--ait-input-background-color);
            border: 1px solid var(--ait-input-border-color);
            border-radius: var(--ait-input-border-radius) !important;

            &:not(.searchBox):not([focused="true"]) input {

                opacity: 0.5

            }

        }

        & .searchBox {

            position: relative;
            border-radius: 1em !important;
            padding: 0 var(--ait-input-horizontal-padding);
            padding-left: calc(var(--ait-input-horizontal-padding) * 2 + 16px);

            & > hbox:last-child,
            & .textbox-search-icons {

                display: none;

            }

            &::before {

                top: 50%;
                content: "";
                width: 16px;
                height: 16px;
                display: block;
                position: absolute;
                transform: translateY(-50%);
                left: var(--ait-input-horizontal-padding);
                margin-right: var(--ait-input-horizontal-padding);
                background-image: var(--ait-searchbox-search-icon);

            }

        }

    }

}

/* -- mail view ------------------------------------------------------------- */

/* -- lightning panel ------------------------------------------------------- */

:root#messengerWindow {

    @each $variant in light, dark {

        &#{ pref(lightning-panel, $variant) } {

            --ait-lightning-view-text-color:
                var(--ait-#{ $variant }-text-color);

            --ait-lightning-view-actions-box-border-color:
                var(--ait-#{ $variant }-pane-border-color);

            --ait-lightning-view-input-borer-color:
                var(--ait-#{ $variant }-input-border-color);

            --ait-lightning-view-button-background-color:
                var(--ait-#{ $variant }-button-background-color);

            --ait-lightning-view-content-background-color:
                var(--ait-#{ $variant }-content-background-color);

            --ait-lightning-view-button-active-border-color:
                var(--ait-#{ $variant }-button-active-border-color);

            --ait-lightning-view-actions-box-background-color:
                var(--ait-#{ $variant }-actions-box-background-color);

            --ait-lightning-view-button-hover-background-color:
                var(--ait-#{ $variant }-button-hover-background-color);

        }

    }

    &#{ pref-not-none(lightning-panel) } {

        & #calendar-view-box {

            position: relative;
            padding-bottom: calc(var(--ait-actions-box-height) -
                                 (1px / var(--ait-pixel-ratio)));

        }

        & #view-tabbox {

            bottom: 0;
            width: 100%;
            text-align: center;
            position: absolute;
            height: var(--ait-actions-box-height);
            background: var(--ait-lightning-view-actions-box-background-color);
            border-top: 1px solid
                        var(--ait-lightning-view-actions-box-border-color);
            border-bottom: 1px solid
                           var(--ait-lightning-view-actions-box-border-color);

            & .navigation-bottombox {

                display: none;

            }

        }

        & #calendar-nav-control {

            border: none;
            background: var(--ait-lightning-view-content-background-color);

            & .navigation-inner-box {

                border: none;

            }

            & :-moz-any(.navigation-spacer-box, .navigation-bottombox) {

                display: none;

            }

            & label {

                font-size: 1.1em;
                font-weight: bold;
                color: var(--ait-lightning-view-text-color);

            }

        }

        & calendar-day-label {

            display: block;
            font-size: 0.9em;
            text-align: left;
            border-left: none;
            text-transform: uppercase;
            background: var(--ait-lightning-view-content-background-color);

            & label {

                margin-top: 6px;
                margin-bottom: 6px;
                color: var(--ait-lightning-view-text-color);

                &:not([hidden="true"]) {

                    display: inline-block;

                }

            }

        }

        & :-moz-any(calendar-month-view, calendar-multiweek-view)
            [anonid="mainbox"] {

            margin-right: 1px;

        }

        & calendar-month-day-box {

            display: flex;
            flex-flow: column;

            & [anonid="monthday-labels"] {

                order: 1;
                padding: 6px;
                display: flex;
                flex-flow: row;

                & > * {

                    flex: 1;
                    display: block;
                    background: none;

                }

            }

            & .calendar-month-day-box-items-box {

                flex: 1 100%;

            }

        }

        & :-moz-any(.calendar-color-box, calendar-event-box) {

            margin-left: 1px;
            text-align: center;
            background-image: none;
            border: none !important;

        }

        & #intervalDescription {

            color: var(--ait-blue) !important;

        }

        & #calendarWeek {

            opacity: 0.5;

        }

        & #view-deck {

            border: none;

            & > * {

                padding: 0;

                & :-moz-any(.labeldaybox-container,
                            .multiday-view-label-day-box) {

                    border-top: none;

                }

            }

            & * {

                border-color: var(--ait-border-color) !important;
                border-width: calc(1px / var(--ait-pixel-ratio)) !important;

            }

        }

        & #view-tabs {

            width: 100%;
            height: 100%;
            display: inline-flex;
            margin: var(--ait-actions-box-input-margin);

            &:before,
            &:after {

                content: "";
                display: inline-block;
                flex: 2;

            }

            & > tab {

                flex: 1;
                margin: 0;
                padding: 0;
                border-radius: 0;
                display: inline-block;
                height: calc(var(--ait-input-height) - 2px);
                background: var(--ait-lightning-view-button-background-color);
                transition: background 200ms ease-out,
                            box-shadow 200ms ease-out;
                border: 1px solid
                        var(--ait-lightning-view-input-borer-color);


                &:not([first-tab="true"]) {

                    border-left: 0;
                    padding-left: 1px;

                }

                &[first-tab="true"] {

                    border-top-left-radius: var(--ait-input-border-radius);
                    border-bottom-left-radius: var(--ait-input-border-radius);

                }

                &:not([last-tab="true"]) {

                    border-right: 0;

                }

                &[last-tab="true"] {

                    border-top-right-radius: var(--ait-input-border-radius);
                    border-bottom-right-radius: var(--ait-input-border-radius);

                }

                &:hover {

                    background:
                        var(--ait-lightning-view-button-hover-background-color);

                    &:not([first-tab="true"]),
                    & + tab {

                        box-shadow:
                            inset 1px 0
                            var(--ait-lightning-view-input-borer-color);

                    }

                }

                &:-moz-any([selected="true"], :active) {

                    transition: none;
                    background: var(--ait-blue);

                    border-color:
                        var(--ait-lightning-view-button-active-border-color);

                    & label {

                        transition: none;
                        color: var(--ait-button-active-text-color);

                    }

                    &:not([first-tab="true"]),
                    & + tab {

                        box-shadow: none !important;

                    }

                }

                & label {

                    font-weight: normal;
                    margin: 0 1em !important;
                    transition: color 200ms ease-out;
                    color: var(--ait-lightning-view-text-color);

                }

            }

        }

    }

}

/* -- lightning side pane --------------------------------------------------- */

:root#messengerWindow {

    &#{ pref(lightning-side-pane, light) } {

        --ait-lightning-side-pane-background-color:
            var(--ait-light-pane-background-color);

    }

    &#{ pref(lightning-side-pane, dark) } {

        --ait-lightning-side-pane-background-color:
            var(--ait-dark-pane-background-color);

    }

    &#{ pref-not-none(lightning-side-pane) } {

        & #today-pane-panel,
        & #today-pane-panel sidebarheader {

            background: var(--ait-lightning-side-pane-background-color);

        }

        & #today-pane-panel {

            position: relative;
            //box-shadow: -1px -1px var(--ait-border-color);

            & sidebarheader {

                font-weight: bold;
                margin: 0.5em 0.5em 0.5em 0;

            }

        }

        & #calendar-task-tree-detail {

            margin: 3px;
            display: flex;
            overflow: hidden;
            flex-flow: column;
            border: 1px solid var(--ait-border-color);
            border-radius: var(--ait-input-border-radius);
            background: var(--ait-actions-box-background-color);

        }

        & #unifinder-todo-tree {

            flex: 1;

            & tree {

                width: 100%;
                height: 100%;

            }

            & .calendar-task-tree {

                border-bottom: 1px solid var(--ait-border-color);

            }

        }

        & #unifinder-task-edit-field {

            margin: var(--ait-actions-box-input-margin);

        }

        & #folderview-cycler-prev .toolbarbutton-icon {

            width: 16px;
            height: 16px;
            list-style-image: none;
            transform: rotate(90deg);

            background-image:
                -moz-element(#ait-lightning-side-pane-down-arrow-icon);

        }

        & #folderview-cycler-next .toolbarbutton-icon {

            width: 16px;
            height: 16px;
            list-style-image: none;
            transform: rotate(-90deg);

            background-image:
                -moz-element(#ait-lightning-side-pane-down-arrow-icon);

        }

    }

}
